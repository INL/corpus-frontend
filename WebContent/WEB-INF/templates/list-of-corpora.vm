#parse("header.vm")

<div class="span12 contentbox">

<h1>Available corpora</h1>
<ul id='corpora'>
</ul>

<script>

var blsUrl = "$blsUrl";

var JQ = jQuery; // dollars are problematic in Velocity

function updateAvailableCorpora() {
	JQ.ajax(blsUrl, {
		"type": "GET",
		"accept": "application/json",
		"dataType": "json",
		"data": {
			"userid": "jan" // debug
		},
		"success": function (data) {
			if (data['error'])
				alert("Error for request: " + data['error']['message']);
			else {
				var listItems = [];
				var indices = data['indices'];
				for (var i = 0; i < indices.length; i++) {
					var index = indices[i];
					listItems.push("<li><a href='./" + index + "/search'>" + index + "</a></li>");
				}
				JQ("#corpora").html(listItems.join(""));
			}
		},
		"error": function (jqXHR, textStatus, errorThrown) {
			alert("Error for request: " + textStatus + "; " + errorThrown);
		},
	});
}

updateAvailableCorpora();

</script>

</div>
	
#parse("footer.vm")