#parse("header.vm")

<div id="successDiv" class="alert alert-success alert-dismissable">
	<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
	<span id="successMessage"></span>
</div>
<div id="errorDiv" class="alert alert-danger alert-dismissable">
	<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
	<span id="errorMessage"></span>
</div>

<div class="col-xs-12 contentbox" data-bls-url="$blsUrl" style="position:relative;min-height:150px;">

	<span id="waitDisplay" class="fa fa-spinner fa-spin searchIndicator" style="position: absolute; left: 50%;"></span>
	
	<div id="corpora-all-container">

		<h1>Available corpora</h1>
	
		<div id="corpora-public-container">
			<hr>
			<h2>Public corpora</h2>

			<!-- 	NOTE: using a table because we'd like to automatically 
    		size width to longest corpus name. There's probably better ways. -->
			<table class="corpora public table">
				<thead>
					<tr>
						<th></th>
						<th></th>
						<th>Size</th>
					</tr>
				</thead>
				<tbody id="corpora"></tbody>
			</table>

		</div>

		<div id="corpora-private-container">
			<hr>
			<h2 id="header-private">Your corpora</h2>
			<p>(logged in as <i data-autoupdate="userId"></i>)</p>

			<table class="corpora private table">
				<colgroup>
					<col class="corpus-name" />
					<col class="delete" />
					<col />
					<col />
					<col />
					<col />
					<col />
				</colgroup>
				<thead>
					<tr>
						<th>Corpus</th>
						<th></th>
						<th class="size">Size</th>
						<th>Format</th>
						<th>Last modified</th>
						<th></th>
						<th></th>
					</tr>
				</thead>
				<tbody id="corpora-private"></tbody>
			</table>
			
			<button class="btn btn-default btn-lg" id="create-corpus" type="button" data-toggle="modal" data-target="#new-corpus-modal">New corpus</button>
		
		</div>
	
	</div>

	<div id="formats-all-container">
		<hr>
		<h2>Your import formats</h2>
		<p>(logged in as <i data-autoupdate="userId"></i>)</p>
	
		<table class="table corpora" data-autoupdate="format">
			<thead>
				<tr>
					<th>Id</th>
					<th>Name</th>
					<th></th>
					<th></th>
				</tr>
			</thead>
			<tbody>
			<!-- filled by clientside js -->
			</tbody>
		</table>
		<button type="button" class="btn btn-lg btn-default" data-toggle="modal" data-target="#new-format-modal">New format</button>

	</div>

</div>

<div class="modal fade modal-fullwidth" id="new-format-modal" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h3>New import format</h3>
			</div>
			
			<div class="modal-body">
				<ul class="nav nav-tabs" id="searchTabs">
					<li class="active"><a href="#format-editor" data-toggle="tab">Simple</a></li>
					<li><a href="#format-wizard" data-toggle="tab">Advanced</a></li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="format-editor">
						
						<div style="display:flex; align-items: flex-end; justify-content: space-between;">
							<div class="form-group" style="margin-right: 50px; flex: 1 1 auto;">
								<label for="format_name">Format name</label>
					            <div class="input-group" style="width:100%">
						            <input type="text" id="format_name" name="format_name" class="form-control" />
						            <select id="format_type" class="selectpicker" data-width="auto" data-style="btn-primary">
						            	<option label="YAML" value="yaml" selected>YAML</option>
						            	<option label="JSON" value="json">JSON</option>
						            </select>
					            </div>
							</div>
	
							<div class="form-group" style="flex: 0 0 auto;">
								<label style="display:block;">Load a file</label>
							
								<span class="btn btn-primary" style="position:relative;">
									<input type="file" name="format_file" id="format_file" style="position:absolute;left:0;top:0;width:0px;height:100%;padding-left:100%;opacity:0;cursor:pointer;overflow:hidden;"/>
									Open file...
								</span>
								
								<select class="selectpicker" id="format_preset" data-autoupdate="format">
									<!-- options filled in by clientside javascript -->
								</select>
								
								<button type="button" name="format_download" id="format_download" class="btn btn-primary" title="Load preset">Load preset</button>
							</div>
						</div>
						
						<textarea id="format_editor" style="width:100%;"></textarea>
					</div>
					<div class="tab-pane" id="format-wizard">
						<div id="configwizard-root"></div>
					</div>
				</div>
				
				<div id="format_error" class="alert alert-danger" style="display:none; margin-top:20px; flex: none;"></div>
			</div>
			
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" id="format_save">Save</button>			
			</div>
			
		</div>
	</div>
</div>

<div class="modal fade" id="new-corpus-modal" tabindex="-1" role="dialog" aria-labelledby="create-corpus" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
	            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	            <h4 class="modal-title">Create New Corpus</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
	                <div class="form-group">
		                <label for="corpus_name">Corpus Name</label>
		                <input type="text" id="corpus_name" name="corpus_name" maxlength="80" class="form-control" />
	                </div>
	                <div class="form-group">
	                    <label for="corpus_document_type" title="The format of the documents that will be stored in the corpus">Document Format</label>
		                <select id="corpus_document_type" name="corpus_document_type" class="selectpicker" data-autoupdate="format">
		                	<!-- filled in through clientside javascript -->
		                </select>
					</div>
				</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">Save</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="upload-file-dialog" tabindex="-1" role="dialog" aria-labelledby="upload-file" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
	            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	            <h4 class="modal-title" id="upload-file-dialog-title">Add <span id="uploadFormat"></span>data to corpus <span id="uploadCorpusName">&hellip;</span></h4>
            </div>
            <div class="modal-body">
				<p>You may upload:</p>
				<ul>
					<li><em>.xml</em> files</li>
					<li><em>.zip</em> or <em>.tar.gz</em> archives containing <em>.xml</em> files</li>
				</ul> 
			    <!-- The fileinput-button span is used to style the file input field as button -->
			    <span id="upload-area" class="btn fileinput-button">
			        <i class="icon icon-upload icon-white"></i>
			        <span>Select files &hellip;</span>
			        <span>Or drop files here &hellip;</span>
			        <!-- The file input field used as target for the file upload widget -->
			        <input id="drop-zone" type="file" name="files[]" data-url="upload" multiple>
			    </span>
				<div class="progress">
					<div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
				</div>
				<div id="uploadSuccessDiv" class="alert alert-success">
					<span id="uploadSuccessMessage"></span>
				</div>
				<div id="uploadErrorDiv" class="alert alert-danger">
					<span id="uploadErrorMessage"></span>
				</div>
            </div>
            <div class="modal-footer">
                <button id='uploadClose' type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>


<div class="modal fade" id="modal-confirm" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
	            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	            <h4 id="modal-confirm-title">Title</h4>
            </div>
            <div class="modal-body">
                <p id="modal-confirm-message">Message</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="modal-confirm-confirm">Confirm</button>
			</div>
		</div>
	</div>
</div>

<link rel="stylesheet" href="$pathToTop/configwizard/css/main.css">
<link rel="stylesheet" href="$pathToTop/css/vendor/codemirror.css">
<link rel="stylesheet" href="$pathToTop/css/corpora.css">

<script src="$pathToTop/js/vendor/codemirror/codemirror.min.js"></script>
<script src="$pathToTop/js/vendor/codemirror/yaml.js"></script>
<script src="$pathToTop/js/vendor/codemirror/javascript.js"></script>
<script src="$pathToTop/js/corpora.js"></script>
<script src="$pathToTop/configwizard/js/main.js"></script>
	
#parse("footer.vm")